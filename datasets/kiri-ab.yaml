# Query hint dataset for Issue #76 - adds metadata.hints so abstract prompts get concrete anchors.
schemaVersion: "1.0.0"
name: "kiri-ab-issue76"
datasetId: "kiri-ab"
description: "Expanded A/B dataset emphasizing abstract terminology with concrete hint metadata."
version: "v2025-11-14-expansion"

defaultParams:
  k: 10
  timeoutMs: 30000

queries:
  - id: "q-bugfix"
    text: "authentication JWT token validation"
    goal: "Locate dataset loader logic touched by JWT regression fix"
    metadata:
      category: "bugfix"
      intent: "Find dataset loader + schema validation"
      tool: "context_bundle"
      tags: ["auth", "security"]
      hints:
        - "loadDatasetFromYAML"
        - "SchemaVersionError"
        - "external/assay-kit/src/dataset/loader.ts"
      expected:
        - "external/assay-kit/src/dataset/loader.ts"
        - "external/assay-kit/src/dataset/schemas/dataset.schema.ts"
  - id: "q-feature"
    text: "plugin system registry initialization"
    goal: "Understand plugin registry bootstrap path"
    metadata:
      category: "feature"
      intent: "Locate plugin registry implementation"
      tool: "context_bundle"
      tags: ["plugins", "architecture"]
      hints:
        - "PluginRegistry"
        - "registerPlugin"
        - "external/assay-kit/src/cli/commands/evaluate.ts"
      expected:
        - "external/assay-kit/src/runner/types.ts"
        - "external/assay-kit/src/cli/commands/evaluate.ts"
  - id: "q-refactor"
    text: "comparison runner pairing strategy"
    goal: "Inspect comparison runner pairing policy for refactor"
    metadata:
      category: "refactor"
      intent: "Find comparison runner internals"
      tool: "context_bundle"
      tags: ["comparison", "runner"]
      hints:
        - "pairingPolicy"
        - "ComparisonRunner"
        - "external/assay-kit/src/runner/index.ts"
      expected:
        - "external/assay-kit/src/runner/types.ts"
        - "external/assay-kit/src/runner/index.ts"
  - id: "q-testfail"
    text: "mann whitney u mannWhitneyU stats/tests.ts statistical analysis"
    goal: "Recover Mann-Whitney U implementation for regression debugging"
    metadata:
      category: "testfail"
      intent: "Locate Mann-Whitney U + rank biserial helpers"
      tool: "context_bundle"
      tags: ["stats", "tests"]
      hints:
        - "mannWhitneyUTest"
        - "rankBiserialEffect"
        - "external/assay-kit/src/stats/mann-whitney.ts"
      expected:
        - "external/assay-kit/src/stats/mann-whitney.ts"
        - "external/assay-kit/src/stats/rank-biserial.ts"
  - id: "q-performance"
    text: "orchestrator orchestratorMain runtime/workerPool.ts scheduling latency"
    goal: "Locate orchestrator bottleneck hot path for perf triage"
    metadata:
      category: "performance"
      intent: "Inspect tuning orchestrator + worker pool"
      tool: "context_bundle"
      tags: ["orchestrator", "runtime"]
      hints:
        - "orchestratorMain"
        - "workerPoolScheduler"
        - "external/assay-kit/src/tuning/orchestrator.ts"
      expected:
        - "external/assay-kit/src/tuning/orchestrator.ts"
        - "external/assay-kit/src/runtime/worker-pool.ts"
  - id: "q-metrics"
    text: "precision recall calculation utility functions"
    goal: "Find shared precision/recall helpers"
    metadata:
      category: "metrics"
      intent: "Locate metrics utilities"
      tool: "context_bundle"
      tags: ["metrics", "evaluation"]
      hints:
        - "precisionAtK"
        - "recallAtK"
        - "external/assay-kit/src/metrics/index.ts"
      expected:
        - "external/assay-kit/src/metrics/index.ts"
        - "external/assay-kit/src/types/metrics.ts"
  - id: "q-adapter"
    text: "search adapter interface implementation"
    goal: "Review search adapter contracts"
    metadata:
      category: "adapter"
      intent: "Locate adapter types & mock implementation"
      tool: "context_bundle"
      tags: ["adapter", "interface"]
      hints:
        - "SearchAdapter"
        - "MockSearchAdapter"
        - "external/assay-kit/src/types/adapters.ts"
      expected:
        - "external/assay-kit/src/types/adapters.ts"
        - "external/assay-kit/src/adapters/mock.ts"
  - id: "q-reporter"
    text: "markdown reporter output formatting"
    goal: "Locate markdown reporter implementation"
    metadata:
      category: "reporter"
      intent: "Inspect reporting outputs"
      tool: "context_bundle"
      tags: ["reporter", "output"]
      hints:
        - "MarkdownReporter"
        - "renderMarkdownResult"
        - "external/assay-kit/src/reporting/markdown.ts"
      expected:
        - "external/assay-kit/src/reporting/markdown.ts"
        - "external/assay-kit/src/types/adapters.ts"
  - id: "q-dataset"
    text: "dataset loader yaml parsing"
    goal: "Find dataset loading logic"
    metadata:
      category: "dataset"
      intent: "Inspect loader + CLI validation"
      tool: "context_bundle"
      tags: ["dataset", "loader"]
      hints:
        - "loadDataset"
        - "validateDatasetCommand"
        - "external/assay-kit/src/cli/commands/validate.ts"
      expected:
        - "external/assay-kit/src/dataset/loader.ts"
        - "external/assay-kit/src/cli/commands/validate.ts"
  - id: "q-integration"
    text: "kiri search adapter http json rpc"
    goal: "Review example KIRI adapter integration"
    metadata:
      category: "integration"
      intent: "Locate example adapter + runner"
      tool: "context_bundle"
      tags: ["kiri", "integration"]
      hints:
        - "KiriSearchAdapter"
        - "runEvaluation"
        - "external/assay-kit/examples/kiri-integration/src/kiri-adapter.ts"
      expected:
        - "external/assay-kit/examples/kiri-integration/src/kiri-adapter.ts"
        - "external/assay-kit/examples/kiri-integration/src/run-evaluation.ts"
  - id: "q-cli-main"
    text: "assay-kit cli main entrypoint command routing"
    goal: "Locate CLI bootstrap and command registration"
    metadata:
      category: "cli"
      intent: "Inspect CLI main entrypoint"
      tool: "context_bundle"
      tags: ["cli", "commands"]
      hints:
        - "runCli"
        - "registerCommands"
        - "external/assay-kit/src/cli/main.ts"
      expected:
        - "external/assay-kit/src/cli/main.ts"
        - "external/assay-kit/src/cli/commands/types.ts"
  - id: "q-cli-compare"
    text: "compare command diff reporter"
    goal: "Inspect CLI compare command to review diff output"
    metadata:
      category: "cli"
      intent: "Trace compare command implementation"
      tool: "context_bundle"
      tags: ["cli", "compare"]
      hints:
        - "executeCompareCommand"
        - "ComparisonReporter"
        - "external/assay-kit/src/cli/commands/compare.ts"
      expected:
        - "external/assay-kit/src/cli/commands/compare.ts"
        - "external/assay-kit/src/runner/comparison.ts"
  - id: "q-baseline"
    text: "baseline loader filesystem snapshot"
    goal: "Find baseline loader that reads saved results"
    metadata:
      category: "baseline"
      intent: "Inspect filesystem baseline implementation"
      tool: "context_bundle"
      tags: ["baseline", "filesystem"]
      hints:
        - "FilesystemBaselineSource"
        - "loadBaselineRun"
        - "external/assay-kit/src/baseline/filesystem.ts"
      expected:
        - "external/assay-kit/src/baseline/filesystem.ts"
        - "external/assay-kit/src/baseline/index.ts"
  - id: "q-plugin-logger"
    text: "plugin lifecycle logging hooks"
    goal: "Review plugin logger behavior"
    metadata:
      category: "plugins"
      intent: "Understand plugin logging hooks"
      tool: "context_bundle"
      tags: ["plugins", "logging"]
      hints:
        - "PluginLogger"
        - "logPluginLifecycle"
        - "external/assay-kit/src/plugins/logger.ts"
      expected:
        - "external/assay-kit/src/plugins/logger.ts"
        - "external/assay-kit/src/plugins/registry.ts"
  - id: "q-plugin-deps"
    text: "plugin dependency resolver validation"
    goal: "Inspect plugin dependency handling"
    metadata:
      category: "plugins"
      intent: "Review dependency validation logic"
      tool: "context_bundle"
      tags: ["plugins", "dependencies"]
      hints:
        - "resolvePluginDependencies"
        - "DependencyValidationError"
        - "external/assay-kit/src/plugins/dependencies.ts"
      expected:
        - "external/assay-kit/src/plugins/dependencies.ts"
        - "external/assay-kit/src/plugins/types.ts"
  - id: "q-runner-analysis"
    text: "statistical analyzer significance detection"
    goal: "Study statistical analyzer for comparisons"
    metadata:
      category: "runner"
      intent: "Inspect statistical analyzer implementation"
      tool: "context_bundle"
      tags: ["runner", "statistics"]
      hints:
        - "StatisticalAnalyzer"
        - "analyzeSignificance"
        - "external/assay-kit/src/runner/statistical-analyzer.ts"
      expected:
        - "external/assay-kit/src/runner/statistical-analyzer.ts"
        - "external/assay-kit/src/runner/comparison-types.ts"
  - id: "q-runner-summary"
    text: "comparison summary builder rows"
    goal: "Locate summary builder logic"
    metadata:
      category: "runner"
      intent: "Inspect comparison summary emitter"
      tool: "context_bundle"
      tags: ["runner", "summary"]
      hints:
        - "buildComparisonSummary"
        - "SummaryRow"
        - "external/assay-kit/src/runner/summary.ts"
      expected:
        - "external/assay-kit/src/runner/summary.ts"
        - "external/assay-kit/src/runner/index.ts"
  - id: "q-metrics-latency"
    text: "latency metric percentile calculation"
    goal: "Review latency metric helpers"
    metadata:
      category: "metrics"
      intent: "Inspect latency metric calculations"
      tool: "context_bundle"
      tags: ["metrics", "latency"]
      hints:
        - "LatencyMetric"
        - "computeLatencyStats"
        - "external/assay-kit/src/metrics/latency.ts"
      expected:
        - "external/assay-kit/src/metrics/latency.ts"
        - "external/assay-kit/src/metrics/index.ts"
  - id: "q-metrics-ranking"
    text: "ranking metrics ndcg precision"
    goal: "Inspect ranking metric implementations"
    metadata:
      category: "metrics"
      intent: "Review NDCG and ranking logic"
      tool: "context_bundle"
      tags: ["metrics", "ranking"]
      hints:
        - "RankingMetric"
        - "dcg"
        - "external/assay-kit/src/metrics/ranking.ts"
      expected:
        - "external/assay-kit/src/metrics/ranking.ts"
        - "external/assay-kit/src/metrics/combined.ts"
  - id: "q-utils-glob"
    text: "glob matcher utility double star"
    goal: "Review glob utility behavior"
    metadata:
      category: "utils"
      intent: "Understand glob matching helper"
      tool: "context_bundle"
      tags: ["utils", "glob"]
      hints:
        - "matchGlob"
        - "GlobPattern"
        - "external/assay-kit/src/utils/glob.ts"
      expected:
        - "external/assay-kit/src/utils/glob.ts"
        - "external/assay-kit/src/utils/index.ts"
  - id: "q-errors-timeout"
    text: "timeout error retry classification"
    goal: "Inspect timeout error helper"
    metadata:
      category: "errors"
      intent: "Review timeout error typing"
      tool: "context_bundle"
      tags: ["errors", "timeouts"]
      hints:
        - "TimeoutError"
        - "retryable"
        - "external/assay-kit/src/errors/timeout-error.ts"
      expected:
        - "external/assay-kit/src/errors/timeout-error.ts"
        - "external/assay-kit/src/errors/index.ts"
  - id: "q-types-query"
    text: "assay query metadata tags"
    goal: "Locate query type definitions"
    metadata:
      category: "types"
      intent: "Inspect query type helpers"
      tool: "context_bundle"
      tags: ["types", "query"]
      hints:
        - "AssayQuery"
        - "QueryMetadata"
        - "external/assay-kit/src/types/query.ts"
      expected:
        - "external/assay-kit/src/types/query.ts"
        - "external/assay-kit/src/types/index.ts"
  - id: "q-types-dataset"
    text: "dataset definition schema types"
    goal: "Review dataset type definitions"
    metadata:
      category: "types"
      intent: "Understand dataset typing"
      tool: "context_bundle"
      tags: ["types", "dataset"]
      hints:
        - "DatasetDefinition"
        - "QueryResultRow"
        - "external/assay-kit/src/types/dataset.ts"
      expected:
        - "external/assay-kit/src/types/dataset.ts"
        - "external/assay-kit/src/types/index.ts"
  - id: "q-reporting-json"
    text: "json reporter emit artifacts"
    goal: "Find JSON reporter implementation"
    metadata:
      category: "reporter"
      intent: "Review JSON reporter outputs"
      tool: "context_bundle"
      tags: ["reporter", "json"]
      hints:
        - "JsonReporter"
        - "writeJsonReport"
        - "external/assay-kit/src/reporting/json.ts"
      expected:
        - "external/assay-kit/src/reporting/json.ts"
        - "external/assay-kit/src/reporting/index.ts"

expected:
  - id: "q-bugfix"
    reference:
      paths:
        - "external/assay-kit/src/dataset/loader.ts"
        - "external/assay-kit/src/dataset/schemas/dataset.schema.ts"
  - id: "q-feature"
    reference:
      paths:
        - "external/assay-kit/src/runner/types.ts"
        - "external/assay-kit/src/cli/commands/evaluate.ts"
  - id: "q-refactor"
    reference:
      paths:
        - "external/assay-kit/src/runner/types.ts"
        - "external/assay-kit/src/runner/index.ts"
  - id: "q-testfail"
    reference:
      paths:
        - "external/assay-kit/src/stats/mann-whitney.ts"
        - "external/assay-kit/src/stats/rank-biserial.ts"
  - id: "q-performance"
    reference:
      paths:
        - "external/assay-kit/src/tuning/orchestrator.ts"
        - "external/assay-kit/src/runtime/worker-pool.ts"
  - id: "q-metrics"
    reference:
      paths:
        - "external/assay-kit/src/metrics/index.ts"
        - "external/assay-kit/src/types/metrics.ts"
  - id: "q-adapter"
    reference:
      paths:
        - "external/assay-kit/src/types/adapters.ts"
        - "external/assay-kit/src/adapters/mock.ts"
  - id: "q-reporter"
    reference:
      paths:
        - "external/assay-kit/src/reporting/markdown.ts"
        - "external/assay-kit/src/types/adapters.ts"
  - id: "q-dataset"
    reference:
      paths:
        - "external/assay-kit/src/dataset/loader.ts"
        - "external/assay-kit/src/cli/commands/validate.ts"
  - id: "q-integration"
    reference:
      paths:
        - "external/assay-kit/examples/kiri-integration/src/kiri-adapter.ts"
        - "external/assay-kit/examples/kiri-integration/src/run-evaluation.ts"
  - id: "q-cli-main"
    reference:
      paths:
        - "external/assay-kit/src/cli/main.ts"
        - "external/assay-kit/src/cli/commands/types.ts"
  - id: "q-cli-compare"
    reference:
      paths:
        - "external/assay-kit/src/cli/commands/compare.ts"
        - "external/assay-kit/src/runner/comparison.ts"
  - id: "q-baseline"
    reference:
      paths:
        - "external/assay-kit/src/baseline/filesystem.ts"
        - "external/assay-kit/src/baseline/index.ts"
  - id: "q-plugin-logger"
    reference:
      paths:
        - "external/assay-kit/src/plugins/logger.ts"
        - "external/assay-kit/src/plugins/registry.ts"
  - id: "q-plugin-deps"
    reference:
      paths:
        - "external/assay-kit/src/plugins/dependencies.ts"
        - "external/assay-kit/src/plugins/types.ts"
  - id: "q-runner-analysis"
    reference:
      paths:
        - "external/assay-kit/src/runner/statistical-analyzer.ts"
        - "external/assay-kit/src/runner/comparison-types.ts"
  - id: "q-runner-summary"
    reference:
      paths:
        - "external/assay-kit/src/runner/summary.ts"
        - "external/assay-kit/src/runner/index.ts"
  - id: "q-metrics-latency"
    reference:
      paths:
        - "external/assay-kit/src/metrics/latency.ts"
        - "external/assay-kit/src/metrics/index.ts"
  - id: "q-metrics-ranking"
    reference:
      paths:
        - "external/assay-kit/src/metrics/ranking.ts"
        - "external/assay-kit/src/metrics/combined.ts"
  - id: "q-utils-glob"
    reference:
      paths:
        - "external/assay-kit/src/utils/glob.ts"
        - "external/assay-kit/src/utils/index.ts"
  - id: "q-errors-timeout"
    reference:
      paths:
        - "external/assay-kit/src/errors/timeout-error.ts"
        - "external/assay-kit/src/errors/index.ts"
  - id: "q-types-query"
    reference:
      paths:
        - "external/assay-kit/src/types/query.ts"
        - "external/assay-kit/src/types/index.ts"
  - id: "q-types-dataset"
    reference:
      paths:
        - "external/assay-kit/src/types/dataset.ts"
        - "external/assay-kit/src/types/index.ts"
  - id: "q-reporting-json"
    reference:
      paths:
        - "external/assay-kit/src/reporting/json.ts"
        - "external/assay-kit/src/reporting/index.ts"
