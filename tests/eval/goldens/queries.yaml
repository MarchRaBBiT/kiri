schemaVersion: "1.0.0"
datasetVersion: "vscode-2025-11-14"
description: "VS Code TypeScript repository queries"
defaultParams:
  k: 10
  tool: "context_bundle"
  boostProfile: "default"
  timeoutMs: 30000

defaultRepo: "vscode"
repos:
  vscode:
    repoPath: "external/vscode"
    dbPath: "external/vscode/.kiri/index.duckdb"

queries:
  - id: vscode-editor-contributions
    query: "registerWorkbenchContribution workbench part"
    tool: "context_bundle"
    intent: "Find where workbench contributions are registered for editor"
    category: "editor"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/browser/workbench.ts"
        - "src/vs/workbench/browser/workbench.contribution.ts"
    tags: ["workbench", "contribution"]
    hints:
      - "registerWorkbenchContribution"
      - "workbench.contribution.ts"
      - "src/vs/workbench/browser/workbench.contribution.ts"
      - "src/vs/workbench/browser/workbench.ts"

  - id: vscode-tree-data-provider
    query: "TreeDataProvider registerTreeDataProvider"
    tool: "context_bundle"
    intent: "Locate TreeDataProvider API implementation"
    category: "api"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/api/common/extHostTreeViews.ts"
        - "src/vs/workbench/browser/parts/views/viewsRegistry.ts"
    tags: ["tree", "extension"]
    hints:
      - "registerTreeDataProvider"
      - "extHostTreeViews.ts"
      - "viewsRegistry"
      - "src/vs/workbench/api/common/extHostTreeViews.ts"
      - "src/vs/workbench/browser/parts/views/viewsRegistry.ts"

  - id: vscode-debug-adapter
    query: "DebugAdapter tracker session"
    tool: "context_bundle"
    intent: "Inspect debug adapter tracker service"
    category: "debug"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/debug/browser/debugAdapterManager.ts"
        - "src/vs/workbench/contrib/debug/common/debug.ts"
    tags: ["debug", "adapter"]
    hints:
      - "DebugAdapterTrackerFactory"
      - "debugAdapterManager.ts"
      - "src/vs/workbench/contrib/debug/browser/debugAdapterManager.ts"
      - "src/vs/workbench/contrib/debug/common/debug.ts"

  - id: vscode-terminal-prompt
    query: "terminal shell integration prompt decoration"
    tool: "context_bundle"
    intent: "Understand terminal shell integration prompt decoration"
    category: "feature"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/terminal/browser/terminalShellIntegration.ts"
        - "src/vs/workbench/contrib/terminal/browser/terminalInstance.ts"
    tags: ["terminal", "shell", "prompt"]
    hints:
      - "terminalShellIntegration"
      - "registerDecorationTypes"
      - "terminalInstance"
      - "terminalShellIntegration.ts"
      - "terminalInstance.ts"
      - "src/vs/workbench/contrib/terminal/browser/terminalShellIntegration.ts"
      - "src/vs/workbench/contrib/terminal/browser/terminalInstance.ts"

  - id: vscode-notebook-kernel
    query: "NotebookKernelService resolveKernelSource"
    tool: "context_bundle"
    intent: "Trace notebook kernel service resolution logic"
    category: "api"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/notebook/browser/services/notebookKernelServiceImpl.ts"
        - "src/vs/workbench/contrib/notebook/common/notebookKernelService.ts"
    tags: ["notebook", "kernel"]
    hints:
      - "NotebookKernelService"
      - "resolveKernelSource"
      - "notebookKernelServiceImpl"
      - "kernelServiceImpl.ts"
      - "src/vs/workbench/contrib/notebook/browser/services/notebookKernelServiceImpl.ts"
      - "src/vs/workbench/contrib/notebook/common/notebookKernelService.ts"

  - id: vscode-merge-editor
    query: "merge editor diff algorithm chunk alignment"
    tool: "context_bundle"
    intent: "Inspect merge editor diff chunk alignment logic"
    category: "feature"
    repo: "vscode"
    params:
      scoringProfile: "editor"
    expected:
      paths:
        - "src/vs/workbench/contrib/mergeEditor/browser/model/mergeEditorModel.ts"
        - "src/vs/workbench/contrib/mergeEditor/browser/view/viewModel.ts"
      patterns:
        - "src/vs/workbench/contrib/mergeEditor/**/*.ts"
    tags: ["merge", "diff", "editor"]
    hints:
      - "mergeEditorModel"
      - "chunkAlignment"
      - "mergeEditorViewModel"
      - "browser/model/mergeEditorModel.ts"
      - "browser/view/viewModel.ts"
      - "lineAlignment.ts"
      - "mergeEditorView"
      - "src/vs/workbench/contrib/mergeEditor/browser/model/mergeEditorModel.ts"
      - "src/vs/workbench/contrib/mergeEditor/browser/view/viewModel.ts"

  - id: vscode-color-theme
    query: "color registry registerColor workbench"
    tool: "context_bundle"
    intent: "Find color registry entries for workbench"
    category: "editor"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/platform/theme/common/colorRegistry.ts"
        - "src/vs/workbench/common/theme.ts"
    tags: ["color", "theme"]
    hints:
      - "registerColor"
      - "colorRegistry"
      - "colorRegistry.ts"
      - "src/vs/platform/theme/common/colorRegistry.ts"
      - "src/vs/workbench/common/theme.ts"

  - id: vscode-file-search
    query: "ripgrepTextSearchEngine fileWalker"
    tool: "context_bundle"
    intent: "Inspect file search implementation"
    category: "infra"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/services/search/node/ripgrepTextSearchEngine.ts"
        - "src/vs/workbench/services/search/common/searchExtTypes.ts"
    tags: ["search", "ripgrep"]
    hints:
      - "ripgrepTextSearchEngine"
      - "fileWalker"
      - "textSearchAdapter"
      - "ripgrepTextSearchEngine.ts"
      - "textSearchAdapter.ts"
      - "src/vs/workbench/services/search/node/ripgrepTextSearchEngine.ts"
      - "src/vs/workbench/services/search/common/searchExtTypes.ts"

  - id: vscode-extension-activation
    query: "ExtensionHostProcess setupActivationEvents"
    tool: "context_bundle"
    intent: "Understand extension activation event wiring"
    category: "api"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/api/common/extHostExtensionService.ts"
        - "src/vs/workbench/services/extensions/browser/extensionHostProcess.ts"
    tags: ["extension", "activation"]
    hints:
      - "setupActivationEvents"
      - "ExtensionHostProcess"
      - "extHostExtensionService"
      - "extensionHostProcess.ts"
      - "src/vs/workbench/api/common/extHostExtensionService.ts"
      - "src/vs/workbench/services/extensions/browser/extensionHostProcess.ts"

  - id: vscode-settings-sync
    query: "settings sync keybindings merge conflict"
    tool: "context_bundle"
    intent: "Review settings sync merge logic"
    category: "feature"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/platform/userDataSync/common/settingsSync.ts"
        - "src/vs/platform/userDataSync/common/abstractSynchronizer.ts"
        - "src/vs/platform/userDataSync/common/userDataSync.ts"
      patterns:
        - "src/vs/platform/userDataSync/**/*.ts"
    tags: ["sync", "settings"]
    hints:
      - "keybindingsMerge"
      - "SyncResource"
      - "settingsSync.ts"
      - "abstractSynchronizer"
      - "userDataSync"
      - "IUserDataSynchroniser"
      - "src/vs/platform/userDataSync/common/settingsSync.ts"
      - "src/vs/platform/userDataSync/common/abstractSynchronizer.ts"
      - "src/vs/platform/userDataSync/common/userDataSync.ts"

  - id: vscode-microtask-debug
    query: "microtaskQueue tracer schedule vs/base"
    tool: "context_bundle"
    intent: "Inspect microtask queue tracer"
    category: "debug"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/base/common/microtaskQueue.ts"
        - "src/vs/platform/telemetry/common/telemetryUtils.ts"
    tags: ["microtask", "telemetry"]
    hints:
      - "MicrotaskQueueTracer"
      - "scheduleMicrotask"
      - "microtaskQueue.ts"
      - "telemetryUtils.ts"
      - "src/vs/base/common/microtaskQueue.ts"
      - "src/vs/platform/telemetry/common/telemetryUtils.ts"

  - id: vscode-task-terminal
    query: "TaskTerminalShellIntegration registerRunProfiles"
    tool: "context_bundle"
    intent: "Understand task terminal shell integration run profiles"
    category: "feature"
    repo: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts"
        - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystemContribution.ts"
    tags: ["task", "terminal"]
    hints:
      - "TaskTerminalShellIntegration"
      - "registerRunProfiles"
      - "terminalTaskSystem.ts"
      - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts"
      - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystemContribution.ts"
      - "terminalTaskSystemContribution"
