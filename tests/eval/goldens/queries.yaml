schemaVersion: "1.0.0"
datasetVersion: "v2025-11-docs-plain"
description: "VS Code TypeScript repository queries"
defaultParams:
  k: 10
  tool: "context_bundle"
  boostProfile: "default"
  timeoutMs: 30000

defaultRepo: "vscode"
repos:
  vscode:
    repoPath: "external/vscode"
    dbPath: "external/vscode/.kiri/index.duckdb"
  kiri-docs:
    repoPath: "."
    dbPath: "var/index.duckdb"
  kiri-docs-plain:
    repoPath: "tmp/docs-plain"
    dbPath: "tmp/docs-plain/.kiri/index.duckdb"
  assay-kit:
    repoPath: "external/assay-kit"
    dbPath: "external/assay-kit/.kiri/index.duckdb"

queries:
  - id: vscode-editor-contributions
    query: "registerWorkbenchContribution workbench part"
    tool: "context_bundle"
    intent: "Find where workbench contributions are registered for editor"
    category: "editor"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/browser/workbench.ts"
        - "src/vs/workbench/browser/workbench.contribution.ts"
        - "src/vs/workbench/common/contributions.ts"
    tags: ["workbench", "contribution"]
    hints:
      - "registerWorkbenchContribution"
      - "workbench.contribution.ts"
      - "src/vs/workbench/browser/workbench.contribution.ts"
      - "src/vs/workbench/browser/workbench.ts"

  - id: vscode-tree-data-provider
    query: "TreeDataProvider registerTreeDataProvider"
    tool: "context_bundle"
    intent: "Locate TreeDataProvider API implementation"
    category: "api"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/api/common/extHostTreeViews.ts"
    tags: ["tree", "extension"]
    hints:
      - "registerTreeDataProvider"
      - "extHostTreeViews.ts"
      - "src/vs/workbench/api/common/extHostTreeViews.ts"

  - id: vscode-debug-adapter
    query: "DebugAdapter tracker session"
    tool: "context_bundle"
    intent: "Inspect debug adapter tracker service"
    category: "debug"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/debug/browser/debugAdapterManager.ts"
        - "src/vs/workbench/contrib/debug/common/debug.ts"
    tags: ["debug", "adapter"]
    hints:
      - "DebugAdapterTrackerFactory"
      - "debugAdapterManager.ts"
      - "src/vs/workbench/contrib/debug/browser/debugAdapterManager.ts"
      - "src/vs/workbench/contrib/debug/common/debug.ts"

  - id: vscode-terminal-prompt
    query: "terminal shell integration prompt decoration"
    tool: "context_bundle"
    intent: "Understand terminal shell integration prompt decoration"
    category: "feature"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/terminal/browser/terminalInstance.ts" # Primary: terminal instance implementation
        - "src/vs/workbench/api/common/extHostTerminalShellIntegration.ts" # Related: extension host integration
        - "src/vs/platform/terminal/common/terminal.ts" # Related: platform definitions
        - "src/vs/workbench/api/browser/mainThreadTerminalShellIntegration.ts" # Related: main thread integration
        - "src/vs/workbench/contrib/terminal/browser/terminal.ts" # Related: terminal browser types
    tags: ["terminal", "shell", "prompt"]
    hints:
      - "terminalShellIntegration"
      - "registerDecorationTypes"
      - "terminalInstance"
      - "terminalShellIntegration.ts"
      - "terminalInstance.ts"
      - "src/vs/workbench/contrib/terminal/browser/terminalShellIntegration.ts"
      - "src/vs/workbench/contrib/terminal/browser/terminalInstance.ts"

  - id: vscode-notebook-kernel
    query: "NotebookKernelService resolveKernelSource"
    tool: "context_bundle"
    intent: "Trace notebook kernel service resolution logic"
    category: "api"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/notebook/browser/services/notebookKernelServiceImpl.ts"
        - "src/vs/workbench/contrib/notebook/common/notebookKernelService.ts"
        - "src/vs/workbench/contrib/notebook/common/notebookCommon.ts"
        - "src/vs/workbench/contrib/notebook/browser/notebookBrowser.ts"
    tags: ["notebook", "kernel"]
    hints:
      - "NotebookKernelService"
      - "resolveKernelSource"
      - "notebookKernelServiceImpl"
      - "kernelServiceImpl.ts"
      - "src/vs/workbench/contrib/notebook/browser/services/notebookKernelServiceImpl.ts"
      - "src/vs/workbench/contrib/notebook/common/notebookKernelService.ts"

  - id: vscode-merge-editor
    query: "merge editor diff algorithm chunk alignment"
    tool: "context_bundle"
    intent: "Inspect merge editor diff chunk alignment logic"
    category: "feature"
    repo: "vscode"
    params:
      boostProfile: "vscode"
      scoringProfile: "editor"
    expected:
      paths:
        - "src/vs/workbench/contrib/mergeEditor/browser/model/mergeEditorModel.ts"
        - "src/vs/workbench/contrib/mergeEditor/browser/view/viewModel.ts"
      patterns:
        - "src/vs/workbench/contrib/mergeEditor/**/*.ts"
    tags: ["merge", "diff", "editor"]
    hints:
      - "mergeEditorModel"
      - "chunkAlignment"
      - "mergeEditorViewModel"
      - "browser/model/mergeEditorModel.ts"
      - "browser/view/viewModel.ts"
      - "lineAlignment.ts"
      - "mergeEditorView"
      - "src/vs/workbench/contrib/mergeEditor/browser/model/mergeEditorModel.ts"
      - "src/vs/workbench/contrib/mergeEditor/browser/view/viewModel.ts"

  - id: vscode-color-theme
    query: "color registry registerColor workbench"
    tool: "context_bundle"
    intent: "Find color registry entries for workbench"
    category: "editor"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/platform/theme/common/colorRegistry.ts"
        - "src/vs/workbench/common/theme.ts"
        - "src/vs/editor/common/core/editorColorRegistry.ts"
        - "src/vs/workbench/contrib/preferences/common/settingsEditorColorRegistry.ts"
    tags: ["color", "theme"]
    hints:
      - "registerColor"
      - "colorRegistry"
      - "colorRegistry.ts"
      - "src/vs/platform/theme/common/colorRegistry.ts"
      - "src/vs/workbench/common/theme.ts"

  - id: vscode-file-search
    query: "ripgrepTextSearchEngine fileWalker"
    tool: "context_bundle"
    intent: "Inspect file search implementation"
    category: "infra"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/services/search/node/ripgrepTextSearchEngine.ts"
        - "src/vs/workbench/services/search/common/searchExtTypes.ts"
        - "src/vs/workbench/services/search/node/textSearchAdapter.ts"
    tags: ["search", "ripgrep"]
    hints:
      - "ripgrepTextSearchEngine"
      - "fileWalker"
      - "textSearchAdapter"
      - "ripgrepTextSearchEngine.ts"
      - "textSearchAdapter.ts"
      - "src/vs/workbench/services/search/node/ripgrepTextSearchEngine.ts"
      - "src/vs/workbench/services/search/common/searchExtTypes.ts"

  - id: vscode-extension-activation
    query: "ExtensionHostProcess setupActivationEvents"
    tool: "context_bundle"
    intent: "Understand extension activation event wiring"
    category: "api"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/api/common/extHostExtensionService.ts"
        - "src/vs/workbench/api/node/extensionHostProcess.ts"
    tags: ["extension", "activation"]
    hints:
      - "setupActivationEvents"
      - "ExtensionHostProcess"
      - "extHostExtensionService"
      - "extensionHostProcess.ts"
      - "src/vs/workbench/api/common/extHostExtensionService.ts"
      - "src/vs/workbench/services/extensions/browser/extensionHostProcess.ts"

  - id: vscode-settings-sync
    query: "settings sync keybindings merge conflict"
    tool: "context_bundle"
    intent: "Review settings sync merge logic"
    category: "feature"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/platform/userDataSync/common/settingsSync.ts"
        - "src/vs/platform/userDataSync/common/abstractSynchronizer.ts"
        - "src/vs/platform/userDataSync/common/userDataSync.ts"
        - "src/vs/platform/userDataSync/common/keybindingsMerge.ts"
      patterns:
        - "src/vs/platform/userDataSync/**/*.ts"
    tags: ["sync", "settings"]
    hints:
      - "keybindingsMerge"
      - "SyncResource"
      - "settingsSync.ts"
      - "abstractSynchronizer"
      - "userDataSync"
      - "IUserDataSynchroniser"
      - "src/vs/platform/userDataSync/common/settingsSync.ts"
      - "src/vs/platform/userDataSync/common/abstractSynchronizer.ts"
      - "src/vs/platform/userDataSync/common/userDataSync.ts"

  - id: vscode-microtask-debug
    query: "microtaskQueue tracer schedule vs/base"
    tool: "context_bundle"
    intent: "Inspect microtask queue tracer"
    category: "debug"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/platform/telemetry/common/telemetryUtils.ts"
    tags: ["microtask", "telemetry"]
    hints:
      - "MicrotaskQueueTracer"
      - "scheduleMicrotask"
      - "microtaskQueue.ts"
      - "telemetryUtils.ts"
      - "src/vs/base/common/microtaskQueue.ts"
      - "src/vs/platform/telemetry/common/telemetryUtils.ts"

  - id: vscode-task-terminal
    query: "TaskTerminalShellIntegration registerRunProfiles"
    tool: "context_bundle"
    intent: "Understand task terminal shell integration run profiles"
    category: "feature"
    repo: "vscode"
    params:
      boostProfile: "vscode"
    expected:
      paths:
        - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts"
    tags: ["task", "terminal"]
    hints:
      - "TaskTerminalShellIntegration"
      - "registerRunProfiles"
      - "terminalTaskSystem.ts"
      - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystem.ts"
      - "src/vs/workbench/contrib/tasks/browser/terminalTaskSystemContribution.ts"
      - "terminalTaskSystemContribution"

  - id: kiri-docs-runbook-degrade
    query: "tag:degrade metrics アラート Runbook"
    intent: "Find the degrade recovery runbook using front matter tags and inbound link boost"
    category: "docs"
    repo: "kiri-docs"
    params:
      boostProfile: "docs"
      timeoutMs: 30000
    expected:
      paths:
        - "docs/runbook.md" # Primary: degrade recovery procedures
        - "docs/operations.md" # Related: operational context (SLO, observability)
        - "docs/search-ranking.md" # Related: ranking behavior during degradation
    tags: ["docs", "operations", "metadata", "links"]
    requiresMetadata: true
    requiresInboundLinks: true
    notes: "Validation target for Markdown front matter tags and markdown_link counts."

  - id: kiri-docs-security-windows
    query: "category:security Windows パイプ リスク"
    intent: "Locate Windows-specific security policy via category metadata"
    category: "docs"
    repo: "kiri-docs"
    params:
      boostProfile: "docs"
    expected:
      paths:
        - "docs/security.md"
        - "docs/runbook.md"
    tags: ["docs", "security", "metadata"]
    requiresMetadata: true
    notes: "Requires front matter category=security to rank above other docs."

  - id: kiri-docs-search-ranking-profile
    query: "tag:ranking boost_profile docs ブラックリスト"
    intent: "Check search-ranking guide for doc boost behavior"
    category: "docs"
    repo: "kiri-docs"
    params:
      boostProfile: "balanced"
    expected:
      paths:
        - "docs/search-ranking.md"
        - "docs/overview.md"
    tags: ["docs", "ranking", "metadata"]
    requiresMetadata: true
    notes: "Ensures metadata tags (ranking) are indexed from Markdown front matter."

  - id: kiri-docs-operations-observability
    query: "tag:observability SLO 1000ms"
    intent: "Retrieve operations observability guide via metadata-only search"
    category: "docs"
    repo: "kiri-docs"
    params:
      boostProfile: "docs"
    expected:
      paths:
        - "docs/operations.md"
        - "docs/runbook.md"
        - "docs/testing.md"
    tags: ["docs", "operations", "metadata"]
    requiresMetadata: true
    notes: "Exercises metadata-only candidate path when query is dominated by tag filters."

  - id: kiri-docs-testing-golden
    query: "tag:golden-set precision at 10"
    intent: "Find testing/evaluation expectations through front matter tags"
    category: "docs"
    repo: "kiri-docs"
    params:
      boostProfile: "docs"
    expected:
      paths:
        - "docs/testing.md"
        - "docs/search-ranking.md"
    tags: ["docs", "testing", "metadata"]
    requiresMetadata: true
    notes: "Validates doc metadata ingestion for testing guide."

  - id: kiri-docs-runbook-degrade-plain
    query: "tag:degrade metrics アラート Runbook"
    intent: "Baseline without front matter tags for degrade recovery runbook"
    category: "docs-plain"
    repo: "kiri-docs-plain"
    params:
      boostProfile: "docs"
      timeoutMs: 30000
    expected:
      paths:
        - "docs/runbook.md"
        - "docs/operations.md"
        - "docs/search-ranking.md"
    tags: ["docs", "operations", "plain"]
    requiresMetadata: true
    requiresInboundLinks: true
    notes: "Plain corpus variant of runbook query（front matter stripped）."

  - id: kiri-docs-security-windows-plain
    query: "category:security Windows パイプ リスク"
    intent: "Plain corpus: locate Windows-specific security policy"
    category: "docs-plain"
    repo: "kiri-docs-plain"
    params:
      boostProfile: "docs"
    expected:
      paths:
        - "docs/security.md"
        - "docs/runbook.md"
    tags: ["docs", "security", "plain"]
    requiresMetadata: true
    notes: "Front matterなしバージョンで metadata pass の低下を観測。"

  - id: kiri-docs-search-ranking-profile-plain
    query: "tag:ranking boost_profile docs ブラックリスト"
    intent: "Plain corpus: verify search-ranking guide retrieval"
    category: "docs-plain"
    repo: "kiri-docs-plain"
    params:
      boostProfile: "balanced"
    expected:
      paths:
        - "docs/search-ranking.md"
        - "docs/overview.md"
    tags: ["docs", "ranking", "plain"]
    requiresMetadata: true
    notes: "metadata削除による precision 低下を確認するための比較用。"

  - id: kiri-docs-operations-observability-plain
    query: "tag:observability SLO 1000ms"
    intent: "Plain corpus: operations observability guide"
    category: "docs-plain"
    repo: "kiri-docs-plain"
    params:
      boostProfile: "docs"
    expected:
      paths:
        - "docs/operations.md"
        - "docs/runbook.md"
        - "docs/testing.md"
    tags: ["docs", "operations", "plain"]
    requiresMetadata: true
    notes: "Metadata-only候補が失われた場合の fallback 精度を測定。"

  - id: kiri-docs-testing-golden-plain
    query: "tag:golden-set precision at 10"
    intent: "Plain corpus: testing/eval expectations"
    category: "docs-plain"
    repo: "kiri-docs-plain"
    params:
      boostProfile: "docs"
    expected:
      paths:
        - "docs/testing.md"
        - "docs/search-ranking.md"
    tags: ["docs", "testing", "plain"]
    requiresMetadata: true
    notes: "front matter なしでの Golden set クエリの比較。"

  - id: assay-plugin-registry
    query: "PluginRegistry registerPlugin dependency graph"
    tool: "context_bundle"
    intent: "Locate plugin registry bootstrap logic in assay-kit"
    category: "feature"
    repo: "assay-kit"
    params:
      boostProfile: "default"
    expected:
      paths:
        - "packages/assay-kit/src/plugins/registry.ts"
        - "packages/assay-kit/src/plugins/logger.ts"
        - "packages/assay-kit/src/plugins/dependencies.ts"
    tags: ["plugin", "registry", "assay-kit"]
    hints:
      - "PluginRegistry"
      - "registerPlugin"

  - id: assay-dataset-loader
    query: "loadDatasetFromYAML schema validation error"
    tool: "context_bundle"
    intent: "Find dataset loader and schema definition for assay-kit"
    category: "feature"
    repo: "assay-kit"
    params:
      boostProfile: "default"
    expected:
      paths:
        - "packages/assay-kit/src/dataset/loader.ts"
        - "packages/assay-kit/src/dataset/schemas/dataset.schema.ts"
        - "packages/assay-kit/src/dataset/schemas/query.schema.ts"
    tags: ["dataset", "schema", "assay-kit"]
    hints:
      - "packages/assay-kit/src/dataset/loader.ts"
      - "packages/assay-kit/src/dataset/schemas/dataset.schema.ts"
      - "packages/assay-kit/src/dataset/schemas/query.schema.ts"
      - "loadDatasetFromYAML"
      - "schema"
      - "validation"
      - "dataset"
      - "loader"

  # Graph Layer A/B comparison queries (kiri-docs with co-change data)
  # Key: use path_prefix to exclude external/ and focus on kiri core files
  # Co-change data from var/index.duckdb:
  #   handlers.ts ↔ scoring.ts: conf=0.19
  #   handlers.ts ↔ rpc.ts: conf=0.20
  #   cli.ts ↔ schema.ts (checked via indexer)

  # Graph-ON tests (cochange enabled)
  - id: kiri-graph-on-server-scoring
    query: "server scoring weight calculation profile"
    tool: "context_bundle"
    intent: "Find scoring module from handlers context (co-change: handlers.ts ↔ scoring.ts, conf=0.19)"
    category: "graph-test"
    repo: "kiri-docs"
    params:
      boostProfile: "default"
      profile: "graph-on"
      path_prefix: "src/"
      artifacts:
        editing_path: "src/server/handlers.ts"
    expected:
      paths:
        # NOTE: editing_path (handlers.ts) is EXCLUDED - only cochange targets
        - "src/server/scoring.ts"       # cochange:17, conf=0.19
        - "src/server/rpc.ts"           # cochange:22, conf=0.20
        - "src/indexer/schema.ts"       # cochange:15, conf=0.14
        - "src/server/main.ts"          # cochange:9, conf=0.08
    tags: ["graph", "cochange", "graph-on"]
    notes: "Co-change should boost scoring.ts, rpc.ts when editing handlers.ts"

  - id: kiri-graph-on-server-rpc
    query: "rpc json handler creation request"
    tool: "context_bundle"
    intent: "Find RPC module from handlers context (co-change: handlers.ts ↔ rpc.ts, conf=0.20)"
    category: "graph-test"
    repo: "kiri-docs"
    params:
      boostProfile: "default"
      profile: "graph-on"
      path_prefix: "src/"
      artifacts:
        editing_path: "src/server/handlers.ts"
    expected:
      paths:
        # NOTE: editing_path (handlers.ts) is EXCLUDED - only cochange targets
        - "src/server/rpc.ts"           # cochange:22, conf=0.20
        - "src/server/scoring.ts"       # cochange:17, conf=0.19
        - "src/server/runtime.ts"       # cochange:8, conf=0.07
        - "src/server/main.ts"          # cochange:9, conf=0.08
    tags: ["graph", "cochange", "graph-on"]
    notes: "Co-change should boost rpc.ts when editing handlers.ts"

  - id: kiri-graph-on-indexer-schema
    query: "indexer database schema table create"
    tool: "context_bundle"
    intent: "Find indexer schema from CLI context (co-change: cli.ts ↔ schema.ts)"
    category: "graph-test"
    repo: "kiri-docs"
    params:
      boostProfile: "default"
      profile: "graph-on"
      path_prefix: "src/"
      artifacts:
        editing_path: "src/indexer/cli.ts"
    expected:
      paths:
        # NOTE: editing_path (cli.ts) is EXCLUDED - only cochange targets
        - "src/indexer/schema.ts"       # cochange with cli.ts
        - "src/server/handlers.ts"      # cochange:16
        - "src/server/scoring.ts"       # cochange:4
    tags: ["graph", "cochange", "graph-on"]
    notes: "Co-change should boost schema.ts when editing cli.ts"

  # Graph-OFF tests (baseline without cochange)
  - id: kiri-graph-off-server-scoring
    query: "server scoring weight calculation profile"
    tool: "context_bundle"
    intent: "Baseline: Find scoring module WITHOUT co-change boost"
    category: "graph-test-baseline"
    repo: "kiri-docs"
    params:
      boostProfile: "default"
      profile: "graph-off"
      path_prefix: "src/"
      artifacts:
        editing_path: "src/server/handlers.ts"
    expected:
      paths:
        # Same expected as graph-on for fair comparison
        - "src/server/scoring.ts"
        - "src/server/rpc.ts"
        - "src/indexer/schema.ts"
        - "src/server/main.ts"
    tags: ["graph", "baseline", "graph-off"]
    notes: "Baseline WITHOUT cochange - compare against graph-on"

  - id: kiri-graph-off-server-rpc
    query: "rpc json handler creation request"
    tool: "context_bundle"
    intent: "Baseline: Find RPC module WITHOUT co-change boost"
    category: "graph-test-baseline"
    repo: "kiri-docs"
    params:
      boostProfile: "default"
      profile: "graph-off"
      path_prefix: "src/"
      artifacts:
        editing_path: "src/server/handlers.ts"
    expected:
      paths:
        # Same expected as graph-on for fair comparison
        - "src/server/rpc.ts"
        - "src/server/scoring.ts"
        - "src/server/runtime.ts"
        - "src/server/main.ts"
    tags: ["graph", "baseline", "graph-off"]
    notes: "Baseline WITHOUT cochange - compare against graph-on"

  - id: kiri-graph-off-indexer-schema
    query: "indexer database schema table create"
    tool: "context_bundle"
    intent: "Baseline: Find indexer schema WITHOUT co-change boost"
    category: "graph-test-baseline"
    repo: "kiri-docs"
    params:
      boostProfile: "default"
      profile: "graph-off"
      path_prefix: "src/"
      artifacts:
        editing_path: "src/indexer/cli.ts"
    expected:
      paths:
        # Same expected as graph-on for fair comparison
        - "src/indexer/schema.ts"
        - "src/server/handlers.ts"
        - "src/server/scoring.ts"
    tags: ["graph", "baseline", "graph-off"]
    notes: "Baseline WITHOUT cochange - compare against graph-on"

  # =================================================================
  # VS Code Graph Layer A/B comparison queries
  # =================================================================
  # Co-change data from external/vscode/.kiri/index.duckdb (1,428 pairs):
  #   chatService.ts ↔ chatServiceImpl.ts: count=11, conf=0.58
  #   chat.contribution.ts ↔ constants.ts: count=8, conf=0.31
  #   commands.ts ↔ repository.ts (git ext): count=6, conf=0.67
  #   chatModel.ts ↔ chatService.ts: count=6, conf=0.32
  #   terminal.ts ↔ terminalChatService.ts: count=6, conf=0.75

  # Graph-ON tests (cochange enabled) for VS Code
  - id: vscode-graph-on-chat-service
    query: "chat service implementation request response"
    tool: "context_bundle"
    intent: "Find chat service impl from service interface context (co-change: 11 commits, conf=0.58)"
    category: "graph-test"
    repo: "vscode"
    params:
      boostProfile: "default"
      profile: "graph-on"
      path_prefix: "src/vs/workbench/contrib/chat/"
      artifacts:
        editing_path: "src/vs/workbench/contrib/chat/common/chatService.ts"
    expected:
      paths:
        # NOTE: editing_path (chatService.ts) is EXCLUDED - only cochange targets
        - "src/vs/workbench/contrib/chat/common/chatServiceImpl.ts"  # cochange:11, conf=0.58
        - "src/vs/workbench/contrib/chat/common/chatModel.ts"        # cochange:6, conf=0.32
        - "src/vs/workbench/contrib/chat/test/common/mockChatService.ts"  # cochange:6, conf=0.40
    tags: ["graph", "cochange", "graph-on", "vscode"]
    notes: "Co-change should boost chatServiceImpl.ts when editing chatService.ts"

  - id: vscode-graph-on-git-commands
    query: "git repository stage commit commands"
    tool: "context_bundle"
    intent: "Find git repository from commands context (co-change: 6 commits, conf=0.67)"
    category: "graph-test"
    repo: "vscode"
    params:
      boostProfile: "default"
      profile: "graph-on"
      path_prefix: "extensions/git/src/"
      artifacts:
        editing_path: "extensions/git/src/commands.ts"
    expected:
      paths:
        # NOTE: editing_path (commands.ts) is EXCLUDED - only cochange targets
        - "extensions/git/src/repository.ts"  # cochange:6, conf=0.67
        - "extensions/git/src/git.ts"         # cochange:5, conf=0.56
        - "extensions/git/src/operation.ts"   # cochange:3, conf=0.38
    tags: ["graph", "cochange", "graph-on", "vscode"]
    notes: "Co-change should boost repository.ts when editing commands.ts"

  - id: vscode-graph-on-terminal-chat
    query: "terminal chat service integration"
    tool: "context_bundle"
    intent: "Find terminal chat service from terminal context (co-change: 6 commits, conf=0.75)"
    category: "graph-test"
    repo: "vscode"
    params:
      boostProfile: "default"
      profile: "graph-on"
      path_prefix: "src/vs/workbench/contrib/"
      artifacts:
        editing_path: "src/vs/workbench/contrib/terminal/browser/terminal.ts"
    expected:
      paths:
        # NOTE: editing_path (terminal.ts) is EXCLUDED - only cochange targets
        - "src/vs/workbench/contrib/terminalContrib/chat/browser/terminalChatService.ts"  # cochange:6, conf=0.75
        - "src/vs/workbench/contrib/terminalContrib/chat/browser/terminalChatWidget.ts"   # cochange:4, conf=0.50
    tags: ["graph", "cochange", "graph-on", "vscode"]
    notes: "Co-change should boost terminalChatService.ts when editing terminal.ts"

  # Graph-OFF tests (baseline without cochange) for VS Code
  - id: vscode-graph-off-chat-service
    query: "chat service implementation request response"
    tool: "context_bundle"
    intent: "Baseline: Find chat service impl WITHOUT co-change boost"
    category: "graph-test-baseline"
    repo: "vscode"
    params:
      boostProfile: "default"
      profile: "graph-off"
      path_prefix: "src/vs/workbench/contrib/chat/"
      artifacts:
        editing_path: "src/vs/workbench/contrib/chat/common/chatService.ts"
    expected:
      paths:
        # Same expected as graph-on for fair comparison
        - "src/vs/workbench/contrib/chat/common/chatServiceImpl.ts"
        - "src/vs/workbench/contrib/chat/common/chatModel.ts"
        - "src/vs/workbench/contrib/chat/test/common/mockChatService.ts"
    tags: ["graph", "baseline", "graph-off", "vscode"]
    notes: "Baseline WITHOUT cochange - compare against graph-on"

  - id: vscode-graph-off-git-commands
    query: "git repository stage commit commands"
    tool: "context_bundle"
    intent: "Baseline: Find git repository WITHOUT co-change boost"
    category: "graph-test-baseline"
    repo: "vscode"
    params:
      boostProfile: "default"
      profile: "graph-off"
      path_prefix: "extensions/git/src/"
      artifacts:
        editing_path: "extensions/git/src/commands.ts"
    expected:
      paths:
        # Same expected as graph-on for fair comparison
        - "extensions/git/src/repository.ts"
        - "extensions/git/src/git.ts"
        - "extensions/git/src/operation.ts"
    tags: ["graph", "baseline", "graph-off", "vscode"]
    notes: "Baseline WITHOUT cochange - compare against graph-on"

  - id: vscode-graph-off-terminal-chat
    query: "terminal chat service integration"
    tool: "context_bundle"
    intent: "Baseline: Find terminal chat service WITHOUT co-change boost"
    category: "graph-test-baseline"
    repo: "vscode"
    params:
      boostProfile: "default"
      profile: "graph-off"
      path_prefix: "src/vs/workbench/contrib/"
      artifacts:
        editing_path: "src/vs/workbench/contrib/terminal/browser/terminal.ts"
    expected:
      paths:
        # Same expected as graph-on for fair comparison
        - "src/vs/workbench/contrib/terminalContrib/chat/browser/terminalChatService.ts"
        - "src/vs/workbench/contrib/terminalContrib/chat/browser/terminalChatWidget.ts"
    tags: ["graph", "baseline", "graph-off", "vscode"]
    notes: "Baseline WITHOUT cochange - compare against graph-on"
